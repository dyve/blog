+++
date = "2009-03-31T13:39:00+00:00"
draft = true
tags = ["JustMigrate", "apple tv", "bittorrent"]
title = "A proper rtorrent install for Apple TV"
+++
<blockquote>
<p>Update September 29, 2010:</p>
<ul>
<li>There is now a <a href="http://dyve.posterous.com/transmission-2-on-apple-tv-3">much better Transmission for Apple TV</a></li>
<li>Instructions on how to downloads torrents via RSS are <a href="http://dyve.posterous.com/automatically-download-tv-shows-to-your-apple-0">also available</a></li>
</ul>
</blockquote>
<p><em>NOTE: This article assumes you have ssh access to your Apple TV, and you are interested in using it as a bittorrent client. It's a bit rough around the edges, but it's (for now) meant for people that kind of already know this stuff, but need an extra tidbit of info to make it work. I'm open to all kinds of feedback on how to improve it.</em></p>
<p><em>&nbsp;</em> <em>DISCLAIMER: If you break or brick your Apple TV while doing this, don't blame me. I cannot guarantee this will work, however, it's working for me.</em> <em>Still here? Let's get to work!</em></p>
<p><em> </em> Since your Apple TV is always on anyway, you might as well use it as a bittorrent client. The simplest way to do this is to install rtorrent. However, the basic Apple TV rtorrent package is lacking some finesse. Nothing that 2 simple files and a few words form the command line cannot solve. Ready? Here we go.</p>
<p><strong>Step 1. Install rtorrent</strong> Get the latest version from <a href="http://code.google.com/p/rtorrent-appletv/" target="_blank">Google Code</a> and follow instructions. It's the usual upload-and-run-the-install-script. You should be fine.  After installation, you should see <em>rtorrent</em> (an executable) in <em>/usr/local/bin</em> on your Apple TV. You can launch it if you like, to see if it works.  <strong></strong></p>
<p><strong>Step 2. Install screen</strong> screen is a very nice Unix tool (a multiplexer) that can do lots of useful stuff. Read more about it on <a href="http://en.wikipedia.org/wiki/GNU_Screen" target="_blank">Wikipedia</a>. Alas, this nifty program is not installed on your Apple TV.However, once upon a time someone made a verty nice plugin for Apple TV 1.0 called <a href="http://wiki.awkwardtv.org/wiki/ATVTorrents" target="_blank">ATVTorrents</a>. Basically, we will try to rebuild the backend of this ATV 1.0 plugin, and we need the screen binary. You can extract it from the ATVTorrents package, or just get it <a href="http://dyve.net/files/screen" target="_self">here</a> (I extracted it for you).  Now, on your Mac (or PC if that's your poison, <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" target="_blank">but you'll have to find an scp program yourself</a>), go to the command line, change to the directory that holds the screen executable and type this:</p>
<p><code>scp screen frontrow@appletv.local:~</code></p>
<p>You should see a response that tells you the file was transferred successfully.  Now, ssh into your Apple TV and type this (the password you will be asked after the sudo command is <em>frontrow</em>).</p>
<p><code>sudo mount -uw /<br /> mv screen /usr/local/bin/<br /> chmod 777 /usr/local/bin/screen<br /> echo export PATH=$PATH:/usr/local/bin &gt; /etc/profile</code></p>
<p>The last command creates a default profile that automatically has access to the new stuff we install. If that interferes with your setup, you might want to create a profile for the frontrow user only.  OK, we're done here, now on to the next step.</p>
<p><strong>Step 3. Install the LaunchAgent</strong> Now we have screen and rtorrent and we want to make them play nice. If you know ho wto work screen, you can probably figure out how to start rtorrent with screen. However, that's not what we want. We don't want to do anything, we just want it to start whenever the Apple TV does. So, what we do is, we take <a href="http://dyve.net/files/org.awkwardtv.rtorrent.plist" target="_blank">this file</a> and we will place it in /Library/LaunchAgents. The file is a modified version of the plist that originally came with the plugin mentioned earlier. That's why the name is still referring to Awkward TV (seems fitting). This file tells the Apple TV to launch <em>rtorrent</em> in the background (using <em>screen</em>) after it has been successfully booted. Which means rtorrent will always be running, which is good (for a bittorrent client).  Transfer the file to your Apple TV (same as the screen file above, use the scp command). Then ssh into your Apple TV and type the following command:</p>
<p><code>mv org.awkwardtv.rtorrent.plist /Library/LaunchAgents/</code></p>
<p><code> </code> If you get a message about a read only file system, repeat the sudo mount command you did before, and try again. You should not have to chmod this file, since it is not an executable.  Now reboot your Apple TV (<em>sudo reboot</em>), get yourself a cup of coffee or whatever you feel like, and when the Apple TV is up and running, ssh into it and type <em>screen -rd</em> at the command line. You should see a nice empty torrent screen. Type Ctrl-A Ctrl-D to exit.</p>
<p><strong>Step 4. Configure rtorrent</strong> (optional but recommended to prevent it from clogging your connection)  Main thing to do is set limits for upload and download bandwith. Edit the file <em>/Users/frontrow/rtorrent.rc</em> on your Apple TV (it's invisible because its name starts with a dot, but it's there). Edit the lines that look like this:</p>
<p><code># Global upload and download rate in KiB. "0" for unlimited.<br /> download_rate = 200 upload_rate = 20</code></p>
<p>How to edit this file?</p>
<p>Method 1: mount your Apple TV using <a href="http://wiki.awkwardtv.org/wiki/Take_2_Full_Update#5.29_Install_AFP" target="_blank">afp</a> and edit the file as if it were on your Mac.</p>
<p>Method 2: install <a href="http://wiki.awkwardtv.org/wiki/Nano" target="_blank">nano</a> (follow the instructions for installing screen) and type <em>/usr/local/bin/nano .rtorrent.rc</em>.</p>
<p>Done! Your Apple TV is now a bittorrent machine. How do you make it do stuff? Simple. You drop torrent files in the folder Torrents (located in the frontrow user's home directory), and when the torrent is done, the result will be placed in your Movies folder. Want to check on rtorrent? ssh into your Apple TV and type <em>screen -rd</em> at the command prompt.</p>